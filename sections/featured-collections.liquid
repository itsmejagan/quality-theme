{% liquid
    assign max_items = section.settings.products_to_show  
    assign list_items_array = list_items | strip | split: '<!--@list/split-->'
    if section.settings.collection != blank and shop.products_count != 0
    assign section_products = section.settings.collection.products
    assign max_items = section_products.size | at_most: section.settings.products_to_show
  endif
  %}
 
 
  {% capture list_items %}
    {% for i in (1..max_items) %}
      {% if section_products.size > 0 %}
        {% assign index = forloop.index0 %}
        {% assign product = section_products[index] %}
      {% else %}
        {% assign product = null %}
      {% endif %}
      <div
        class="resource-list__item"
      >
        {% content_for 'block', type: 'product-card', id: 'static-product-card', closest.product: product %}
      </div>

      {% unless forloop.last %}
        <!--@list/split-->
      {% endunless %}

    {% endfor %}
  {% endcapture %}
  
<div class="full-width {{ section.settings | class_list }} color-{{ section.settings.color_scheme }}"> 
 {{ list_items }}
</div>

<ul class="product-grid">
  {% for product in section.settings.collection.products %}
    <li>
      {% content_for "block", type: "product-card", id: "card", closest.product: product %}
    </li>
  {% endfor %}
</ul>

{% schema %}
{
  "name": "Featured collection",  
  "blocks": [{ "type": "@theme" }, { "type": "@app" }],
   "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
     {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },   
    {
      "type": "collection",
      "id": "collection",
      "label": "t:settings.collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 3,
      "max": 12,
      "step": 1,
      "default": 4,
      "label": "t:sections.featured-collection.settings.products_to_show.label"
    },
    {
      "type": "select",
      "id": "desktop",
      "options": [
        {
          "value": "3",
           "label": "t:sections.all.column_option.desktop.options__1.label"
        },
        {
          "value": "4",
          "label": "t:sections.all.column_option.desktop.options__2.label"
        },
        {
          "value": "5",
          "label": "t:sections.all.column_option.desktop.options__3.label"
        },
        {
          "value": "6",
          "label": "t:sections.all.column_option.desktop.options__5.label"
        }
      ],
      "default": "4",
       "label": "t:sections.all.column_option.desktop.label"
    },
    {
      "type": "select",
      "id": "mobile",
      "options": [
        {
          "value": "1",
           "label": "t:sections.all.column_option.mobile.options__1.label"
        },
        {
          "value": "2",
           "label": "t:sections.all.column_option.mobile.options__2.label"
        }
      ],
      "default": "1",
       "label": "t:sections.all.column_option.mobile.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.swiper.swiper_slider_title"
    },
    {
      "type": "checkbox",
      "id": "swiper_enable",
      "default": false,
      "label": "t:sections.all.swiper.swiper_slider_enable"
    },
    {
      "type": "range",
      "id": "auto_play",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit":"s",
      "label": "t:sections.all.swiper.auto_play",
      "info": "t:sections.all.swiper.info",
      "default": 0
    },
    {
      "type": "range",
      "id": "space",
      "min": 5,
      "max": 60,
      "step": 5,
      "unit":"px",
      "label": "t:sections.all.swiper.space",
      "info":"t:sections.all.swiper.gap_info",
      "default": 20
    },

    {
    "type": "select",
    "id": "styles",
    "options": [
    {
    "value": "dots",
    "label": "t:sections.all.style.options__2.label"
    },
    {
    "value": "arrow",
    "label": "t:sections.all.style.options__3.label"
    },
       {
    "value": "none",
    "label": "t:sections.all.style.options__1.label"
    }
    ],
    "default": "none",
    "label": "t:sections.all.style.label"
    },
    {
    "type": "select",
    "id": "nav_style",
    "options": [
    {
    "value": "classic",
    "label": "t:sections.all.nav_style.options__1.label"
    },
    {
    "value": "modern",
    "label": "t:sections.all.nav_style.options__2.label"
    }
    ],
    "default": "classic",
    "label": "t:sections.all.nav_style.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 100
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 100
    }
  ],
  "presets": [
    {
      "name": "Featured collections",
      "category": "products",
      "settings": {
        "collection": "",
        "products_to_show": 8,                
        "desktop": "4",
        "mobile": "2",
        "swiper_enable": false,
        "auto_play": 5,
        "space": 10,
        "styles": "none",
        "nav_style": "classic",       
        "color_scheme": "scheme-1",
        "padding_top": 40,
        "padding_bottom": 40
      },
      "blocks": {        
        "static-product-card": {
          "type": "product-card",
          "name": "product_card",
          "static": true,
          "settings": {
            "product": "{{ closest.product }}",
            "product_card_gap": 8,
            "inherit_color_scheme": true,
            "color_scheme": "",
            "border": "none",
            "border_width": 1,
            "border_opacity": 100,
            "border_radius": 0,
            "padding-block-start": 0,
            "padding-block-end": 0,
            "padding-inline-start": 0,
            "padding-inline-end": 0
          },
          "blocks": {
            "card-gallery": {
              "type": "_product-card-gallery",
              "name": "product_card_media",
              "settings": {
                "product": "{{ closest.product }}",
                "image_ratio": "portrait"
              },
              "blocks": {}
            },
            "group": {
              "type": "group",
              "name": "group",
              "settings": {               
              },
              "blocks": {
                "price": {
                  "type": "price",
                  "name": "price",
                  "settings": {
                    "product": "{{ closest.product }}",
                   
                  }
                },
                "product_title": {
                  "type": "product-title",
                  "name": "product_title",
                  "settings": {
                    "product": "{{ closest.product }}"                    
                  }
                },
                "swatches": {
                  "type": "swatches",
                  "name": "t:names.swatches",
                  "settings": {
                    "product": "{{ closest.product }}"                                      
                  }
                }
              },
              "block_order": ["product_title", "price", "swatches"]
            }
          },
          "block_order": ["card-gallery", "group"]
        }
      }
    } 
  ]
}
      {% endschema %}
